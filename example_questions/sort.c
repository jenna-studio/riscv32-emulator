#include <stdint.h>

#define N 1024
#define MMIO_ADDR ((volatile uint32_t *)0x10000)

/* data[] mirrors the .data section exactly (N = 1024 elements) */
static int32_t data[N] = {
    4915,8335,1514,8927,3676,9773,5783,1541,8857,3285,1284,3004,4295,5815,9408,1608,
    163,8300,2890,5170,1625,1948,8754,3311,2117,2214,1385,6497,1044,356,1841,1662,
    4021,8574,7531,2816,9418,3113,2824,6898,6842,1555,1795,3324,4960,3358,8663,4313,
    4476,8257,7575,1696,5494,6340,3136,908,9535,6792,8058,6180,764,7850,3321,1421,
    3757,8733,7889,8429,8444,1288,9132,8821,3997,639,5032,7973,716,9011,3860,3061,
    2533,3072,4360,1081,7439,3446,5905,3242,2107,9067,6860,8084,898,4637,6645,5819,
    7207,5728,3016,2160,5664,2738,1340,2226,1194,970,6000,3940,5621,6134,681,5488,
    6972,5857,1245,1420,909,6644,7532,6189,32,2524,9285,4322,5021,5094,9940,4766,
    3691,8398,7064,718,6527,1745,7170,9289,3571,3761,8619,8213,8949,1480,1124,6445,
    951,9814,7708,2648,4887,2796,6791,697,2249,9655,6930,8109,3478,7205,6768,8358,
    3564,8345,8253,433,9060,9386,5644,2789,1080,5210,4799,6603,2906,9774,9297,3923,
    941,3928,5578,6063,8094,324,7329,6154,6188,2952,2028,643,772,828,6939,9284,3014,
    28,4709,1852,5478,3266,4646,6412,580,8249,1799,1922,6750,2974,4786,6675,6193,2790,
    6044,6476,9680,2832,9852,744,3451,4733,5759,633,6092,5058,2503,9288,9705,1913,4302,
    9241,5400,8588,9131,9945,5999,1655,1726,7418,7861,8851,1634,6585,2392,9335,7606,1493,
    380,9389,5638,4597,5513,2414,143,7818,5159,2184,636,3417,1444,7527,2023,2616,7615,
    8320,6662,5560,3894,3017,6485,88,6482,8638,7097,9725,4530,2483,3971,7781,448,7024,
    5798,4911,648,2002,4662,2803,3060,8835,492,5188,9633,6928,2034,3269,4303,2025,3052,
    6008,15,9611,7498,8031,3758,8870,1589,2635,9343,6951,8132,3407,7033,758,4326,3990,
    3491,1984,5176,4494,3279,4884,5779,4068,9170,1983,86,4042,1409,8059,2468,1724,1003,
    9106,1054,6133,9686,8060,4955,7201,5668,3361,3636,3521,7934,6731,4745,4602,6251,1991,
    1873,7951,195,9574,1706,234,5017,4616,5173,7295,3914,2895,7232,9071,7991,742,9301,
    5000,6320,2390,7988,2706,2212,2794,9380,2875,9504,405,5399,736,8930,8184,662,1271,
    3442,2708,315,5128,1079,1538,2008,5535,5377,295,3675,6449,9636,7184,3876,7390,2681,
    960,6304,9246,65,8825,182,5858,2830,952,8283,7584,4404,3653,4804,5951,9766,2299,
    8631,8417,1565,4951,8387,1915,9262,3465,1654,1968,5246,6010,3619,9964,1701,7187,
    8185,3224,7424,4878,6356,4300,2956,8098,7867,2606,2589,4122,1600,560,3646,8276,936,
    7240,6965,1439,4946,711,5197,2473,6174,8095,2801,1266,196,7787,8053,2375,6095,5796,
    5328,7183,1345,6594,9271,1874,8016,2888,4258,9098,5430,7937,9477,9023,4197,6635,
    6432,2346,3603,7986,5764,9943,3664,3854,6248,613,4798,6530,2638,2043,2791,6104,4989,
    3895,507,144,5286,5353,5360,1960,6098,140,1638,839,3473,3293,6973,1097,592,10000,
    3985,9066,5464,7947,7035,6710,254,8464,8633,8179,265,5031,9211,5656,6605,7538,3588,
    8836,6289,3419,1159,9807,6863,3409,9676,2467,2411,7441,7338,2144,465,5771,8275,8640,
    7275,2522,5714,7362,5301,638,8388,8167,6228,8100,2349,485,9083,6166,692,5825,2355,
    686,8505,1013,1629,9550,7766,798,1312,5166,6561,8617,8362,8353,7309,3169,3068,8827,
    8969,7065,5268,3500,2677,8721,4606,1759,4027,115,8591,4719,6280,6609,9213,6395,5849,
    3364,4170,7697,1102,1723,6261,2936,765,6172,569,8015,4120,7695,4019,9220,5630,5813,
    7534,1114,5917,6808,1358,462,3723,6844,7434,7046,9980,7510,8147,4325,8936,5262,8495,
    5681,8611,4522,3241,6802,4831,5408,8818,7996,5051,5238,996,5642,524,8852,131,9303,
    7264,1217,2480,9431,2728,4866,523,7085,8614,9894,8899,9530,7254,9120,844,882,4620,
    8786,4156,1398,615,5209,1323,6940,8616,3075,6861,9049,1905,5227,21,3567,5956,8131,
    2838,5872,819,2031,421,2537,9439,6394,217,6093,5904,8994,4682,3392,9749,6423,7811,
    7799,9687,7303,7692,865,5300,5502,4690,8011,2387,5836,757,5249,7200,9037,9017,7314,
    1956,496,4966,8997,2251,1235,6238,7876,6638,8756,6984,2823,3591,3396,7980,1466,5082,
    2325,7536,3275,4,1467,3717,33,6036,7871,2998,9553,9924,7907,5809,2576,7379,471,4410,
    6886,1478,3133,1110,1774,9560,2870,827,7196,7449,1647,2817,4452,7604,313,2448,670,
    5814,5344,7237,4260,1561,8860,1770,8439,1211,9669,9006,892,4632,9656,7279,537,7726,
    1153,3427,4577,9509,4051,3129,4919,2975,6183,7931,2982,3929,2863,4666,2183,5194,2256,
    3094,9044,1829,8397,4112,8816,5341,1065,7537,3706,2715,1830,7081,4248,2641,5263,8893,
    969,8692,7975,283,8553,5205,663,4186,1015,5047,7450,1236,9888,3849,2878,9968,5122,
    6502,8725,5891,1918,3357,4628,3639,7747,4189,7557,664,2069,4944,4664,4570,4731,3494,
    159,9619,8380,8019,3051,1180,9528,7600,5143,9954,2893,7815,6721,7821,2922,8842,9425,
    9168,8012,8482,3522,3552,6221,6514,6629,982,6567,8858,4352,2427,6011,3793,1648,872,
    5232,8805,5123,6322,8955,8092,910,5582,3278,5838,2302,111,7346,5068,9121,3762,7775,
    9265,9221,3056,2383,2682,8628,5105,7407,3287,5845,1754,5785,4153,1107,9683,8705,4297,
    7817,3663,6344,7981,3648,4902,3637,7191,2615,2723,4900,6351,2021,8165,9134,7644,2646,
    7014,9828,1953,47,6355,2733,8554,5064,8156,539,3687,4824,5044,7412,957,2271,6753,
    3906,7629,954,9881,3485,4631,7940,6671,5546,6257,4379,9897,5069,1127,3518,3524,5520,
    5433,833,1117,1567,9874,1702,1195,4939,826,9564,7518,7596,2759,7355,393,220,1228,
    7212,8346,6201,5899,6677,611,572,3053,2853,9840,369,3408,879,5310,2696,1481,1494,
    4111,5774,2119,7021,9042,6461,4905,2221,9831,8129,2201,4335,3753,3975,7698,1190
};

static volatile uint32_t *output = (volatile uint32_t *)65536;

/* Partition function: partitions [low, high) using last element as pivot.
   Places all elements < pivot to the left; returns final pivot index. */
static int partition(int low, int high) {
    int pivot = data[high - 1];
    int i = low;
    for (int j = low; j < high - 1; ++j) {
        if (data[j] < pivot) {
            int tmp = data[i];
            data[i] = data[j];
            data[j] = tmp;
            i++;
        }
    }
    int tmp = data[i];
    data[i] = data[high - 1];
    data[high - 1] = tmp;
    return i;
}

/* Quicksort over half-open interval [low, high) */
static void sort(int low, int high) {
    if (low >= high) return;
    int p = partition(low, high);
    sort(low, p);
    sort(p + 1, high);
}

/* printres: counts how many times the array decreases compared to previous element,
   then writes that count to MMIO at *output. */
static void printres(void) {
    int prev = 0;
    int count = 0;
    for (int i = 0; i <= 1023; ++i) {
        int v = data[i];
        if (prev > v) {
            count += 1;
        }
        prev = v;
    }
    *output = (uint32_t)count;
}

int main(void) {
    sort(0, 1024);
    printres();

    /* hcf: halt */
    for (;;)
        ;
}